# 技術選定チェックリスト

新機能追加や外部サービス導入前に、このチェックリストを使って総合的に判断する。

## 目的

- コスト超過を防ぐ
- 技術的リスクを事前評価
- 代替案を含めた比較検討
- 長期的な保守性を確保

## チェックリスト

### 1. コスト評価

| 項目 | 確認内容 | 判断基準 |
|------|---------|---------|
| 初期費用 | セットアップ・導入にかかる費用は？ | できるだけ無料 |
| 月額費用 | 固定の月額費用は？ | 目安: 1000円/月以下 |
| 使用量課金 | API呼び出し・データ転送量等の従量課金は？ | 予測可能な範囲内 |
| 無料枠 | 無料プラン・無料枠は存在するか？ | あれば優先検討 |
| スケール時のコスト | ユーザー数増加時のコスト増加率は？ | 線形またはそれ以下 |

**判断基準**:
- ✅ **採用**: 月額コストが予算内 & スケール時も予測可能
- ⚠️ **要検討**: 無料枠内で運用可能だが、超過リスクあり
- ❌ **見送り**: 高コストまたは予測不可能な従量課金

### 2. 技術評価

| 項目 | 確認内容 | 判断基準 |
|------|---------|---------|
| 自前実装との比較 | 自前で実装した場合の工数・複雑度は？ | 外部サービスの方が明らかに有利か |
| 代替手段 | 他に選択肢はあるか？ | 必ず2つ以上検討 |
| サーバースペック | 現在のサーバーで動作するか？ | スペック不足なら見送りまたはプラン変更 |
| 保守・運用 | 導入後の保守は容易か？ | 属人化しない技術か |
| ドキュメント | 公式ドキュメント・コミュニティは充実しているか？ | 問題解決が容易か |

**判断基準**:
- ✅ **採用**: 自前実装より明らかに工数削減 & ドキュメント充実
- ⚠️ **要検討**: 工数削減効果はあるが学習コストが高い
- ❌ **見送り**: 自前実装の方がシンプルまたは学習コストが高すぎる

### 3. リスク評価

| 項目 | 確認内容 | 判断基準 |
|------|---------|---------|
| ベンダーロックイン | 他サービスへの移行は容易か？ | 移行パスが存在するか |
| サービス終了 | サービス終了時の影響は？ | 代替手段への移行コストは？ |
| セキュリティ | データ保護・プライバシーは適切か？ | GDPR, 個人情報保護法対応 |
| パフォーマンス | レスポンスタイム・スループットは十分か？ | SLA保証はあるか |
| 依存関係 | 他システムへの影響は？ | 障害時の影響範囲は？ |

**判断基準**:
- ✅ **採用**: リスクが低いまたは軽減策が明確
- ⚠️ **要検討**: リスクはあるが許容範囲内
- ❌ **見送り**: クリティカルなリスクあり

## 判断フロー

```
新機能・外部サービス検討
  ↓
[1] コスト評価
  ├─ 月額1000円以下？ → YES → 次へ
  └─ NO → 代替案検討 or 見送り
  ↓
[2] 技術評価
  ├─ 自前実装より有利？ → YES → 次へ
  ├─ 代替案は2つ以上検討した？ → YES → 次へ
  └─ NO → 再検討
  ↓
[3] リスク評価
  ├─ クリティカルなリスクなし？ → YES → 採用
  └─ NO → 軽減策検討 or 見送り
```

## 実践例（pachislot-setting-predictionより）

### 事例1: Google OAuth認証

#### コスト評価
- 初期費用: 無料（Google Cloud Console設定のみ）
- 月額費用: 無料枠あり
- 使用量課金: **API呼び出し数に応じて課金の可能性**
- スケール時: ユーザー数増加で課金リスク

**判断**: ⚠️ 要検討（有料化リスク）

#### 技術評価
- 自前実装: Laravel Breezeで十分
- 代替手段:
  1. Laravel Breeze（メール/パスワード）
  2. Laravel Socialite + GitHub OAuth（無料）

**判断**: ⚠️ 自前実装で十分

#### 総合判断: ❌ **見送り**
- 理由: コスト不確実性 & 自前実装で要件充足

### 事例2: チャットボット（LLM API）

#### コスト評価
- OpenAI API: 使用量課金（$0.002/1k tokens）
- Claude API: 使用量課金（$0.003/1k tokens）
- 月間想定: 100万tokens → $200〜$300/月

**判断**: ❌ 高コスト

#### 技術評価
- 代替手段:
  1. ルールベースFAQ（無料・工数大）
  2. ローカルLLM（Ollama + Llama）→ サーバースペック不足
  3. FAQページ + お問い合わせフォーム（無料・シンプル）

**判断**: ✅ 代替案3を採用

#### 総合判断: ❌ **見送り**（将来的な拡張機能として検討）
- 理由: 高コスト & 代替手段で当面対応可能

### 事例3: 役割ベースアクセス制御

#### コスト評価
- 費用: 無料（自前実装）
- 工数: 中程度（マイグレーション + ミドルウェア + ビュー）

**判断**: ✅ 問題なし

#### 技術評価
- 外部パッケージ: spatie/laravel-permission（高機能だが今回は過剰）
- 自前実装: シンプルなenum型カラムで十分

**判断**: ✅ 自前実装

#### 総合判断: ✅ **採用**（自前実装）
- 理由: 無料 & 要件にフィット & 保守性高い

## まとめ

### 重要ポイント

1. **必ず代替案を2つ以上検討する**
2. **月額コスト1000円を目安にする**
3. **使用量課金は予測可能な範囲内に留める**
4. **自前実装の工数を過小評価しない**
5. **将来の拡張性も考慮する**

### 迷ったら

- **まずは最小実装から始める**
- **有料サービスは後から追加可能**
- **無料枠内で試してから判断**
- **ユーザーフィードバックを得てから本格導入**

---

**関連ドキュメント**:
- [サーバープラン選定ガイド](./SERVER_PLANNING.md)
- [開発ワークフロー](./DEVELOPMENT_WORKFLOW.md)
- [ケーススタディ](./CASE_STUDIES.md)
